{"remainingRequest":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\plugins\\download.js","dependencies":[{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\plugins\\download.js","mtime":1733705220496},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\babel.config.js","mtime":1733705220203},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9Vc2Vycy9jaGVueGkvRGVza3RvcC9wcm8vUWluZ1hpblNhYVMvcWluZ3hpbnNhYXMtdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyIpOwp2YXIgX3JlZ2VuZXJhdG9yUnVudGltZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkM6L1VzZXJzL2NoZW54aS9EZXNrdG9wL3Byby9RaW5nWGluU2FhUy9xaW5neGluc2Fhcy11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9yZWdlbmVyYXRvclJ1bnRpbWUuanMiKSk7CnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkM6L1VzZXJzL2NoZW54aS9EZXNrdG9wL3Byby9RaW5nWGluU2FhUy9xaW5neGluc2Fhcy11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yLmpzIikpOwp2YXIgX2F4aW9zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJheGlvcyIpKTsKdmFyIF9lbGVtZW50VWkgPSByZXF1aXJlKCJlbGVtZW50LXVpIik7CnZhciBfZmlsZVNhdmVyID0gcmVxdWlyZSgiZmlsZS1zYXZlciIpOwp2YXIgX2F1dGggPSByZXF1aXJlKCJAL3V0aWxzL2F1dGgiKTsKdmFyIF9lcnJvckNvZGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvdXRpbHMvZXJyb3JDb2RlIikpOwp2YXIgX3J1b3lpID0gcmVxdWlyZSgiQC91dGlscy9ydW95aSIpOwp2YXIgYmFzZVVSTCA9IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEk7CnZhciBkb3dubG9hZExvYWRpbmdJbnN0YW5jZTsKdmFyIF9kZWZhdWx0ID0gZXhwb3J0cy5kZWZhdWx0ID0gewogIHppcDogZnVuY3Rpb24gemlwKHVybCwgbmFtZSkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHZhciB1cmwgPSBiYXNlVVJMICsgdXJsOwogICAgZG93bmxvYWRMb2FkaW5nSW5zdGFuY2UgPSBfZWxlbWVudFVpLkxvYWRpbmcuc2VydmljZSh7CiAgICAgIHRleHQ6ICLmraPlnKjkuIvovb3mlbDmja7vvIzor7fnqI3lgJkiLAogICAgICBzcGlubmVyOiAiZWwtaWNvbi1sb2FkaW5nIiwKICAgICAgYmFja2dyb3VuZDogInJnYmEoMCwgMCwgMCwgMC43KSIKICAgIH0pOwogICAgKDAsIF9heGlvcy5kZWZhdWx0KSh7CiAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgIHVybDogdXJsLAogICAgICByZXNwb25zZVR5cGU6ICdibG9iJywKICAgICAgaGVhZGVyczogewogICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgKDAsIF9hdXRoLmdldFRva2VuKSgpCiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICB2YXIgaXNCbG9iID0gKDAsIF9ydW95aS5ibG9iVmFsaWRhdGUpKHJlcy5kYXRhKTsKICAgICAgaWYgKGlzQmxvYikgewogICAgICAgIHZhciBibG9iID0gbmV3IEJsb2IoW3Jlcy5kYXRhXSwgewogICAgICAgICAgdHlwZTogJ2FwcGxpY2F0aW9uL3ppcCcKICAgICAgICB9KTsKICAgICAgICBfdGhpcy5zYXZlQXMoYmxvYiwgbmFtZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMucHJpbnRFcnJNc2cocmVzLmRhdGEpOwogICAgICB9CiAgICAgIGRvd25sb2FkTG9hZGluZ0luc3RhbmNlLmNsb3NlKCk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAocikgewogICAgICBjb25zb2xlLmVycm9yKHIpOwogICAgICBfZWxlbWVudFVpLk1lc3NhZ2UuZXJyb3IoJ+S4i+i9veaWh+S7tuWHuueOsOmUmeivr++8jOivt+iBlOezu+euoeeQhuWRmO+8gScpOwogICAgICBkb3dubG9hZExvYWRpbmdJbnN0YW5jZS5jbG9zZSgpOwogICAgfSk7CiAgfSwKICBzYXZlQXM6IGZ1bmN0aW9uIHNhdmVBcyh0ZXh0LCBuYW1lLCBvcHRzKSB7CiAgICAoMCwgX2ZpbGVTYXZlci5zYXZlQXMpKHRleHQsIG5hbWUsIG9wdHMpOwogIH0sCiAgcHJpbnRFcnJNc2c6IGZ1bmN0aW9uIHByaW50RXJyTXNnKGRhdGEpIHsKICAgIHJldHVybiAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKC8qI19fUFVSRV9fKi8oMCwgX3JlZ2VuZXJhdG9yUnVudGltZTIuZGVmYXVsdCkoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciByZXNUZXh0LCByc3BPYmosIGVyck1zZzsKICAgICAgcmV0dXJuICgwLCBfcmVnZW5lcmF0b3JSdW50aW1lMi5kZWZhdWx0KSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGRhdGEudGV4dCgpOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXNUZXh0ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgcnNwT2JqID0gSlNPTi5wYXJzZShyZXNUZXh0KTsKICAgICAgICAgICAgZXJyTXNnID0gX2Vycm9yQ29kZS5kZWZhdWx0W3JzcE9iai5jb2RlXSB8fCByc3BPYmoubXNnIHx8IF9lcnJvckNvZGUuZGVmYXVsdFsnZGVmYXVsdCddOwogICAgICAgICAgICBfZWxlbWVudFVpLk1lc3NhZ2UuZXJyb3IoZXJyTXNnKTsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0KfTs="},{"version":3,"names":["_axios","_interopRequireDefault","require","_elementUi","_fileSaver","_auth","_errorCode","_ruoyi","baseURL","process","env","VUE_APP_BASE_API","downloadLoadingInstance","_default","exports","default","zip","url","name","_this","Loading","service","text","spinner","background","axios","method","responseType","headers","getToken","then","res","isBlob","blobValidate","data","blob","Blob","type","saveAs","printErrMsg","close","catch","r","console","error","Message","opts","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","resText","rspObj","errMsg","wrap","_callee$","_context","prev","next","sent","JSON","parse","errorCode","code","msg","stop"],"sources":["C:/Users/chenxi/Desktop/pro/QingXinSaaS/qingxinsaas-ui/src/plugins/download.js"],"sourcesContent":["import axios from 'axios'\r\nimport {Loading, Message} from 'element-ui'\r\nimport { saveAs } from 'file-saver'\r\nimport { getToken } from '@/utils/auth'\r\nimport errorCode from '@/utils/errorCode'\r\nimport { blobValidate } from \"@/utils/ruoyi\";\r\n\r\nconst baseURL = process.env.VUE_APP_BASE_API\r\nlet downloadLoadingInstance;\r\n\r\nexport default {\r\n  zip(url, name) {\r\n    var url = baseURL + url\r\n    downloadLoadingInstance = Loading.service({ text: \"正在下载数据，请稍候\", spinner: \"el-icon-loading\", background: \"rgba(0, 0, 0, 0.7)\", })\r\n    axios({\r\n      method: 'get',\r\n      url: url,\r\n      responseType: 'blob',\r\n      headers: { 'Authorization': 'Bearer ' + getToken() }\r\n    }).then((res) => {\r\n      const isBlob = blobValidate(res.data);\r\n      if (isBlob) {\r\n        const blob = new Blob([res.data], { type: 'application/zip' })\r\n        this.saveAs(blob, name)\r\n      } else {\r\n        this.printErrMsg(res.data);\r\n      }\r\n      downloadLoadingInstance.close();\r\n    }).catch((r) => {\r\n      console.error(r)\r\n      Message.error('下载文件出现错误，请联系管理员！')\r\n      downloadLoadingInstance.close();\r\n    })\r\n  },\r\n  saveAs(text, name, opts) {\r\n    saveAs(text, name, opts);\r\n  },\r\n  async printErrMsg(data) {\r\n    const resText = await data.text();\r\n    const rspObj = JSON.parse(resText);\r\n    const errMsg = errorCode[rspObj.code] || rspObj.msg || errorCode['default']\r\n    Message.error(errMsg);\r\n  }\r\n}\r\n\r\n"],"mappings":";;;;;;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AACA,IAAAG,KAAA,GAAAH,OAAA;AACA,IAAAI,UAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,MAAA,GAAAL,OAAA;AAEA,IAAMM,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,gBAAgB;AAC5C,IAAIC,uBAAuB;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEb;EACbC,GAAG,WAAHA,GAAGA,CAACC,GAAG,EAAEC,IAAI,EAAE;IAAA,IAAAC,KAAA;IACb,IAAIF,GAAG,GAAGT,OAAO,GAAGS,GAAG;IACvBL,uBAAuB,GAAGQ,kBAAO,CAACC,OAAO,CAAC;MAAEC,IAAI,EAAE,YAAY;MAAEC,OAAO,EAAE,iBAAiB;MAAEC,UAAU,EAAE;IAAsB,CAAC,CAAC;IAChI,IAAAC,cAAK,EAAC;MACJC,MAAM,EAAE,KAAK;MACbT,GAAG,EAAEA,GAAG;MACRU,YAAY,EAAE,MAAM;MACpBC,OAAO,EAAE;QAAE,eAAe,EAAE,SAAS,GAAG,IAAAC,cAAQ,EAAC;MAAE;IACrD,CAAC,CAAC,CAACC,IAAI,CAAC,UAACC,GAAG,EAAK;MACf,IAAMC,MAAM,GAAG,IAAAC,mBAAY,EAACF,GAAG,CAACG,IAAI,CAAC;MACrC,IAAIF,MAAM,EAAE;QACV,IAAMG,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACL,GAAG,CAACG,IAAI,CAAC,EAAE;UAAEG,IAAI,EAAE;QAAkB,CAAC,CAAC;QAC9DlB,KAAI,CAACmB,MAAM,CAACH,IAAI,EAAEjB,IAAI,CAAC;MACzB,CAAC,MAAM;QACLC,KAAI,CAACoB,WAAW,CAACR,GAAG,CAACG,IAAI,CAAC;MAC5B;MACAtB,uBAAuB,CAAC4B,KAAK,CAAC,CAAC;IACjC,CAAC,CAAC,CAACC,KAAK,CAAC,UAACC,CAAC,EAAK;MACdC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;MAChBG,kBAAO,CAACD,KAAK,CAAC,kBAAkB,CAAC;MACjChC,uBAAuB,CAAC4B,KAAK,CAAC,CAAC;IACjC,CAAC,CAAC;EACJ,CAAC;EACDF,MAAM,WAANA,MAAMA,CAAChB,IAAI,EAAEJ,IAAI,EAAE4B,IAAI,EAAE;IACvB,IAAAR,iBAAM,EAAChB,IAAI,EAAEJ,IAAI,EAAE4B,IAAI,CAAC;EAC1B,CAAC;EACKP,WAAW,WAAXA,WAAWA,CAACL,IAAI,EAAE;IAAA,WAAAa,kBAAA,CAAAhC,OAAA,mBAAAiC,oBAAA,CAAAjC,OAAA,IAAAkC,IAAA,UAAAC,QAAA;MAAA,IAAAC,OAAA,EAAAC,MAAA,EAAAC,MAAA;MAAA,WAAAL,oBAAA,CAAAjC,OAAA,IAAAuC,IAAA,UAAAC,SAAAC,QAAA;QAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;UAAA;YAAAF,QAAA,CAAAE,IAAA;YAAA,OACAxB,IAAI,CAACZ,IAAI,CAAC,CAAC;UAAA;YAA3B6B,OAAO,GAAAK,QAAA,CAAAG,IAAA;YACPP,MAAM,GAAGQ,IAAI,CAACC,KAAK,CAACV,OAAO,CAAC;YAC5BE,MAAM,GAAGS,kBAAS,CAACV,MAAM,CAACW,IAAI,CAAC,IAAIX,MAAM,CAACY,GAAG,IAAIF,kBAAS,CAAC,SAAS,CAAC;YAC3EjB,kBAAO,CAACD,KAAK,CAACS,MAAM,CAAC;UAAC;UAAA;YAAA,OAAAG,QAAA,CAAAS,IAAA;QAAA;MAAA,GAAAf,OAAA;IAAA;EACxB;AACF,CAAC","ignoreList":[]}]}