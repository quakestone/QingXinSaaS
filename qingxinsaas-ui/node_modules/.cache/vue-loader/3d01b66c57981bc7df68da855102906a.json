{"remainingRequest":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\components\\Process\\panel\\multiInstance.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\components\\Process\\panel\\multiInstance.vue","mtime":1733705220398},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge1N0clV0aWx9IGZyb20gJ0AvdXRpbHMvU3RyVXRpbCcNCg0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJNdWx0aUluc3RhbmNlIiwNCiAgLyoqIOe7hOS7tuS8oOWAvCAgKi8NCiAgcHJvcHM6IHsNCiAgICBpZDogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgcmVxdWlyZWQ6IHRydWUNCiAgICB9LA0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwNCiAgICAgIGxvb3BDaGFyYWN0ZXJpc3RpY3M6ICIiLA0KICAgICAgbG9vcEluc3RhbmNlRm9ybToge30sDQogICAgICBtdWx0aUxvb3BJbnN0YW5jZToge30sDQogICAgICBkZWZhdWx0TG9vcEluc3RhbmNlRm9ybTogew0KICAgICAgICBjb21wbGV0aW9uQ29uZGl0aW9uOiAiIiwNCiAgICAgICAgbG9vcENhcmRpbmFsaXR5OiAiIiwNCiAgICAgICAgZXh0ZW5zaW9uRWxlbWVudHM6IFtdLA0KICAgICAgICBhc3luY0FmdGVyOiBmYWxzZSwNCiAgICAgICAgYXN5bmNCZWZvcmU6IGZhbHNlLA0KICAgICAgICBleGNsdXNpdmU6IGZhbHNlDQogICAgICB9LA0KICAgIH0NCiAgfSwNCg0KICAvKiog5Lyg5YC855uR5ZCsICovDQogIHdhdGNoOiB7DQogICAgaWQ6IHsNCiAgICAgIGhhbmRsZXIobmV3VmFsKSB7DQogICAgICAgIGlmIChTdHJVdGlsLmlzTm90QmxhbmsobmV3VmFsKSkgew0KICAgICAgICAgIHRoaXMuZ2V0RWxlbWVudExvb3AodGhpcy5tb2RlbGVyU3RvcmUuZWxlbWVudC5idXNpbmVzc09iamVjdCk7ICAgICAgICB9DQogICAgICB9LA0KICAgICAgaW1tZWRpYXRlOiB0cnVlLCAvLyDnq4vljbPnlJ/mlYgNCiAgICB9LA0KICB9LA0KICBjcmVhdGVkKCkgew0KDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDmlrnms5XljLoNCiAgICBnZXRFbGVtZW50TG9vcChidXNpbmVzc09iamVjdCkgew0KICAgICAgaWYgKCFidXNpbmVzc09iamVjdC5sb29wQ2hhcmFjdGVyaXN0aWNzKSB7DQogICAgICAgIHRoaXMubG9vcENoYXJhY3RlcmlzdGljcyA9ICJOdWxsIjsNCiAgICAgICAgdGhpcy5sb29wSW5zdGFuY2VGb3JtID0ge307DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGlmIChidXNpbmVzc09iamVjdC5sb29wQ2hhcmFjdGVyaXN0aWNzLiR0eXBlID09PSAiYnBtbjpTdGFuZGFyZExvb3BDaGFyYWN0ZXJpc3RpY3MiKSB7DQogICAgICAgIHRoaXMubG9vcENoYXJhY3RlcmlzdGljcyA9ICJTdGFuZGFyZExvb3AiOw0KICAgICAgICB0aGlzLmxvb3BJbnN0YW5jZUZvcm0gPSB7fTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgaWYgKGJ1c2luZXNzT2JqZWN0Lmxvb3BDaGFyYWN0ZXJpc3RpY3MuaXNTZXF1ZW50aWFsKSB7DQogICAgICAgIHRoaXMubG9vcENoYXJhY3RlcmlzdGljcyA9ICJTZXF1ZW50aWFsTXVsdGlJbnN0YW5jZSI7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmxvb3BDaGFyYWN0ZXJpc3RpY3MgPSAiUGFyYWxsZWxNdWx0aUluc3RhbmNlIjsNCiAgICAgIH0NCiAgICAgIC8vIOWQiOW5tumFjee9rg0KICAgICAgdGhpcy5sb29wSW5zdGFuY2VGb3JtID0gew0KICAgICAgICAuLi50aGlzLmRlZmF1bHRMb29wSW5zdGFuY2VGb3JtLA0KICAgICAgICAuLi5idXNpbmVzc09iamVjdC5sb29wQ2hhcmFjdGVyaXN0aWNzLA0KICAgICAgICBjb21wbGV0aW9uQ29uZGl0aW9uOiBidXNpbmVzc09iamVjdC5sb29wQ2hhcmFjdGVyaXN0aWNzPy5jb21wbGV0aW9uQ29uZGl0aW9uPy5ib2R5ID8/ICIiLA0KICAgICAgICBsb29wQ2FyZGluYWxpdHk6IGJ1c2luZXNzT2JqZWN0Lmxvb3BDaGFyYWN0ZXJpc3RpY3M/Lmxvb3BDYXJkaW5hbGl0eT8uYm9keSA/PyAiIg0KICAgICAgfTsNCiAgICAgIC8vIOS/neeVmeW9k+WJjeWFg+e0oCBidXNpbmVzc09iamVjdCDkuIrnmoQgbG9vcENoYXJhY3RlcmlzdGljcyDlrp7kvosNCiAgICAgIHRoaXMubXVsdGlMb29wSW5zdGFuY2UgPSB0aGlzLm1vZGVsZXJTdG9yZS5lbGVtZW50LmJ1c2luZXNzT2JqZWN0Lmxvb3BDaGFyYWN0ZXJpc3RpY3M7DQogICAgICAvLyDmm7TmlrDooajljZUNCiAgICAgIGlmICgNCiAgICAgICAgYnVzaW5lc3NPYmplY3QubG9vcENoYXJhY3RlcmlzdGljcy5leHRlbnNpb25FbGVtZW50cyAmJg0KICAgICAgICBidXNpbmVzc09iamVjdC5sb29wQ2hhcmFjdGVyaXN0aWNzLmV4dGVuc2lvbkVsZW1lbnRzLnZhbHVlcyAmJg0KICAgICAgICBidXNpbmVzc09iamVjdC5sb29wQ2hhcmFjdGVyaXN0aWNzLmV4dGVuc2lvbkVsZW1lbnRzLnZhbHVlcy5sZW5ndGgNCiAgICAgICkgew0KICAgICAgICB0aGlzLiRzZXQodGhpcy5sb29wSW5zdGFuY2VGb3JtLCAidGltZUN5Y2xlIiwgYnVzaW5lc3NPYmplY3QubG9vcENoYXJhY3RlcmlzdGljcy5leHRlbnNpb25FbGVtZW50cy52YWx1ZXNbMF0uYm9keSk7DQogICAgICB9DQogICAgfSwNCg0KICAgIGNoYW5nZUxvb3BDaGFyYWN0ZXJpc3RpY3NUeXBlKHR5cGUpIHsNCiAgICAgIC8vIOWIh+aNouexu+Wei+WPlua2iOWOn+ihqOWNlemFjee9rg0KICAgICAgdGhpcy5sb29wSW5zdGFuY2VGb3JtID0gey4uLnRoaXMuZGVmYXVsdExvb3BJbnN0YW5jZUZvcm19Ow0KICAgICAgLy8g5Y+W5raI5aSa5a6e5L6L6YWN572uDQogICAgICBpZiAodHlwZSA9PT0gIk51bGwiKSB7DQogICAgICAgIHRoaXMubW9kZWxlclN0b3JlLm1vZGVsaW5nLnVwZGF0ZVByb3BlcnRpZXModGhpcy5tb2RlbGVyU3RvcmUuZWxlbWVudCwge2xvb3BDaGFyYWN0ZXJpc3RpY3M6IG51bGx9KTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgLy8g6YWN572u5b6q546vDQogICAgICBpZiAodHlwZSA9PT0gIlN0YW5kYXJkTG9vcCIpIHsNCiAgICAgICAgY29uc3QgbG9vcENoYXJhY3RlcmlzdGljc09iamVjdCA9IHRoaXMubW9kZWxlclN0b3JlLm1vZGRsZS5jcmVhdGUoImJwbW46U3RhbmRhcmRMb29wQ2hhcmFjdGVyaXN0aWNzIik7DQogICAgICAgIHRoaXMubW9kZWxlclN0b3JlLm1vZGVsaW5nLnVwZGF0ZVByb3BlcnRpZXModGhpcy5tb2RlbGVyU3RvcmUuZWxlbWVudCwgew0KICAgICAgICAgIGxvb3BDaGFyYWN0ZXJpc3RpY3M6IGxvb3BDaGFyYWN0ZXJpc3RpY3NPYmplY3QNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubXVsdGlMb29wSW5zdGFuY2UgPSBudWxsOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICAvLyDml7bluo8NCiAgICAgIGlmICh0eXBlID09PSAiU2VxdWVudGlhbE11bHRpSW5zdGFuY2UiKSB7DQogICAgICAgIHRoaXMubXVsdGlMb29wSW5zdGFuY2UgPSB0aGlzLm1vZGVsZXJTdG9yZS5tb2RkbGUuY3JlYXRlKCJicG1uOk11bHRpSW5zdGFuY2VMb29wQ2hhcmFjdGVyaXN0aWNzIiwgew0KICAgICAgICAgIGlzU2VxdWVudGlhbDogdHJ1ZQ0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMubXVsdGlMb29wSW5zdGFuY2UgPSB0aGlzLm1vZGVsZXJTdG9yZS5tb2RkbGUuY3JlYXRlKCJicG1uOk11bHRpSW5zdGFuY2VMb29wQ2hhcmFjdGVyaXN0aWNzIik7DQogICAgICB9DQogICAgICB0aGlzLm1vZGVsZXJTdG9yZS5tb2RlbGluZy51cGRhdGVQcm9wZXJ0aWVzKHRoaXMubW9kZWxlclN0b3JlLmVsZW1lbnQsIHsNCiAgICAgICAgbG9vcENoYXJhY3RlcmlzdGljczogdGhpcy5tdWx0aUxvb3BJbnN0YW5jZQ0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIC8vIOW+queOr+WfuuaVsA0KICAgIHVwZGF0ZUxvb3BDYXJkaW5hbGl0eShjYXJkaW5hbGl0eSkgew0KICAgICAgbGV0IGxvb3BDYXJkaW5hbGl0eSA9IG51bGw7DQogICAgICBpZiAoY2FyZGluYWxpdHkgJiYgY2FyZGluYWxpdHkubGVuZ3RoKSB7DQogICAgICAgIGxvb3BDYXJkaW5hbGl0eSA9IHRoaXMubW9kZWxlclN0b3JlLm1vZGRsZS5jcmVhdGUoImJwbW46Rm9ybWFsRXhwcmVzc2lvbiIsIHtib2R5OiBjYXJkaW5hbGl0eX0pOw0KICAgICAgfQ0KICAgICAgdGhpcy5tb2RlbGVyU3RvcmUubW9kZWxpbmcudXBkYXRlTW9kZGxlUHJvcGVydGllcyh0aGlzLm1vZGVsZXJTdG9yZS5lbGVtZW50LCB0aGlzLm11bHRpTG9vcEluc3RhbmNlLCB7DQogICAgICAgIGxvb3BDYXJkaW5hbGl0eQ0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIC8vIOWujOaIkOadoeS7tg0KICAgIHVwZGF0ZUxvb3BDb25kaXRpb24oY29uZGl0aW9uKSB7DQogICAgICBsZXQgY29tcGxldGlvbkNvbmRpdGlvbiA9IG51bGw7DQogICAgICBpZiAoY29uZGl0aW9uICYmIGNvbmRpdGlvbi5sZW5ndGgpIHsNCiAgICAgICAgY29tcGxldGlvbkNvbmRpdGlvbiA9IHRoaXMubW9kZWxlclN0b3JlLm1vZGRsZS5jcmVhdGUoImJwbW46Rm9ybWFsRXhwcmVzc2lvbiIsIHtib2R5OiBjb25kaXRpb259KTsNCiAgICAgIH0NCiAgICAgIHRoaXMubW9kZWxlclN0b3JlLm1vZGVsaW5nLnVwZGF0ZU1vZGRsZVByb3BlcnRpZXModGhpcy5tb2RlbGVyU3RvcmUuZWxlbWVudCwgdGhpcy5tdWx0aUxvb3BJbnN0YW5jZSwgew0KICAgICAgICBjb21wbGV0aW9uQ29uZGl0aW9uDQogICAgICB9KTsNCiAgICB9LA0KDQogICAgLy8g6YeN6K+V5ZGo5pyfDQogICAgdXBkYXRlTG9vcFRpbWVDeWNsZSh0aW1lQ3ljbGUpIHsNCiAgICAgIGNvbnN0IGV4dGVuc2lvbkVsZW1lbnRzID0gdGhpcy5tb2RlbGVyU3RvcmUubW9kZGxlLmNyZWF0ZSgiYnBtbjpFeHRlbnNpb25FbGVtZW50cyIsIHsNCiAgICAgICAgdmFsdWVzOiBbDQogICAgICAgICAgdGhpcy5tb2RlbGVyU3RvcmUubW9kZGxlLmNyZWF0ZShgZmxvd2FibGU6RmFpbGVkSm9iUmV0cnlUaW1lQ3ljbGVgLCB7DQogICAgICAgICAgICBib2R5OiB0aW1lQ3ljbGUNCiAgICAgICAgICB9KQ0KICAgICAgICBdDQogICAgICB9KTsNCiAgICAgIHRoaXMubW9kZWxlclN0b3JlLm1vZGVsaW5nLnVwZGF0ZU1vZGRsZVByb3BlcnRpZXModGhpcy5tb2RlbGVyU3RvcmUuZWxlbWVudCwgdGhpcy5tdWx0aUxvb3BJbnN0YW5jZSwgew0KICAgICAgICBleHRlbnNpb25FbGVtZW50cw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIC8vIOebtOaOpeabtOaWsOeahOWfuuehgOS/oeaBrw0KICAgIHVwZGF0ZUxvb3BCYXNlKCkgew0KICAgICAgdGhpcy5tb2RlbGVyU3RvcmUubW9kZWxpbmcudXBkYXRlTW9kZGxlUHJvcGVydGllcyh0aGlzLm1vZGVsZXJTdG9yZS5lbGVtZW50LCB0aGlzLm11bHRpTG9vcEluc3RhbmNlLCB7DQogICAgICAgIGNvbGxlY3Rpb246IHRoaXMubG9vcEluc3RhbmNlRm9ybS5jb2xsZWN0aW9uIHx8IG51bGwsDQogICAgICAgIGVsZW1lbnRWYXJpYWJsZTogdGhpcy5sb29wSW5zdGFuY2VGb3JtLmVsZW1lbnRWYXJpYWJsZSB8fCBudWxsDQogICAgICB9KTsNCiAgICB9LA0KDQogICAgLy8g5ZCE5byC5q2l54q25oCBDQogICAgdXBkYXRlTG9vcEFzeW5jKGtleSkgew0KICAgICAgY29uc3Qge2FzeW5jQmVmb3JlLCBhc3luY0FmdGVyfSA9IHRoaXMubG9vcEluc3RhbmNlRm9ybTsNCiAgICAgIGxldCBhc3luY0F0dHIgPSBPYmplY3QuY3JlYXRlKG51bGwpOw0KICAgICAgaWYgKCFhc3luY0JlZm9yZSAmJiAhYXN5bmNBZnRlcikgew0KICAgICAgICB0aGlzLiRzZXQodGhpcy5sb29wSW5zdGFuY2VGb3JtLCAiZXhjbHVzaXZlIiwgZmFsc2UpOw0KICAgICAgICBhc3luY0F0dHIgPSB7YXN5bmNCZWZvcmU6IGZhbHNlLCBhc3luY0FmdGVyOiBmYWxzZSwgZXhjbHVzaXZlOiBmYWxzZSwgZXh0ZW5zaW9uRWxlbWVudHM6IG51bGx9Ow0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgYXN5bmNBdHRyW2tleV0gPSB0aGlzLmxvb3BJbnN0YW5jZUZvcm1ba2V5XTsNCiAgICAgIH0NCiAgICAgIHRoaXMubW9kZWxlclN0b3JlLm1vZGVsaW5nLnVwZGF0ZU1vZGRsZVByb3BlcnRpZXModGhpcy5tb2RlbGVyU3RvcmUuZWxlbWVudCwgdGhpcy5tdWx0aUxvb3BJbnN0YW5jZSwgYXN5bmNBdHRyKTsNCiAgICB9DQogIH0NCn0NCg0K"},{"version":3,"sources":["multiInstance.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"multiInstance.vue","sourceRoot":"src/components/Process/panel","sourcesContent":["<template>\r\n  <div class=\"panel-tab__content\">\r\n    <el-form label-width=\"70px\" @submit.native.prevent size=\"small\">\r\n      <el-form-item label=\"参数说明\">\r\n        <el-button size=\"small\" type=\"primary\" @click=\"dialogVisible = true\">查看</el-button>\r\n      </el-form-item>\r\n      <el-form-item label=\"回路特性\">\r\n        <el-select v-model=\"loopCharacteristics\" @change=\"changeLoopCharacteristicsType\">\r\n          <!--bpmn:MultiInstanceLoopCharacteristics-->\r\n          <el-option label=\"并行多重事件\" value=\"ParallelMultiInstance\" />\r\n          <el-option label=\"时序多重事件\" value=\"SequentialMultiInstance\" />\r\n          <!--bpmn:StandardLoopCharacteristics-->\r\n          <el-option label=\"循环事件\" value=\"StandardLoop\" />\r\n          <el-option label=\"无\" value=\"Null\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <template v-if=\"loopCharacteristics === 'ParallelMultiInstance' || loopCharacteristics === 'SequentialMultiInstance'\">\r\n        <el-form-item label=\"循环基数\" key=\"loopCardinality\">\r\n          <el-input v-model=\"loopInstanceForm.loopCardinality\" clearable @change=\"updateLoopCardinality\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"集合\" key=\"collection\">\r\n          <el-input v-model=\"loopInstanceForm.collection\" clearable @change=\"updateLoopBase\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"元素变量\" key=\"elementVariable\">\r\n          <el-input v-model=\"loopInstanceForm.elementVariable\" clearable @change=\"updateLoopBase\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"完成条件\" key=\"completionCondition\">\r\n          <el-input v-model=\"loopInstanceForm.completionCondition\" clearable @change=\"updateLoopCondition\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"异步状态\" key=\"async\">\r\n          <el-checkbox v-model=\"loopInstanceForm.asyncBefore\" label=\"异步前\" @change=\"updateLoopAsync('asyncBefore')\" />\r\n          <el-checkbox v-model=\"loopInstanceForm.asyncAfter\" label=\"异步后\" @change=\"updateLoopAsync('asyncAfter')\" />\r\n          <el-checkbox\r\n              v-model=\"loopInstanceForm.exclusive\"\r\n              v-if=\"loopInstanceForm.asyncAfter || loopInstanceForm.asyncBefore\"\r\n              label=\"排除\"\r\n              @change=\"updateLoopAsync('exclusive')\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"重试周期\" prop=\"timeCycle\" v-if=\"loopInstanceForm.asyncAfter || loopInstanceForm.asyncBefore\" key=\"timeCycle\">\r\n          <el-input v-model=\"loopInstanceForm.timeCycle\" clearable @change=\"updateLoopTimeCycle\" />\r\n        </el-form-item>\r\n      </template>\r\n    </el-form>\r\n\r\n  <!-- 参数说明 -->\r\n  <el-dialog title=\"多实例参数\" :visible.sync=\"dialogVisible\" width=\"680px\" @closed=\"$emit('close')\">\r\n    <el-descriptions :column=\"1\" border>\r\n      <el-descriptions-item label=\"使用说明\">按照BPMN2.0规范的要求，用于为每个实例创建执行的父执行，会提供下列变量:</el-descriptions-item>\r\n      <el-descriptions-item label=\"collection(集合变量)\">传入List参数, 一般为用户ID集合</el-descriptions-item>\r\n      <el-descriptions-item label=\"elementVariable(元素变量)\">List中单个参数的名称</el-descriptions-item>\r\n      <el-descriptions-item label=\"loopCardinality(基数)\">List循环次数</el-descriptions-item>\r\n      <el-descriptions-item label=\"isSequential(串并行)\">Parallel: 并行多实例，Sequential: 串行多实例</el-descriptions-item>\r\n      <el-descriptions-item label=\"completionCondition(完成条件)\">任务出口条件</el-descriptions-item>\r\n      <el-descriptions-item label=\"nrOfInstances(实例总数)\">实例总数</el-descriptions-item>\r\n      <el-descriptions-item label=\"nrOfActiveInstances(未完成数)\">当前活动的（即未完成的），实例数量。对于顺序多实例，这个值总为1</el-descriptions-item>\r\n      <el-descriptions-item label=\"nrOfCompletedInstances(已完成数)\">已完成的实例数量</el-descriptions-item>\r\n      <el-descriptions-item label=\"loopCounter\">给定实例在for-each循环中的index</el-descriptions-item>\r\n    </el-descriptions>\r\n  </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {StrUtil} from '@/utils/StrUtil'\r\n\r\n\r\nexport default {\r\n  name: \"MultiInstance\",\r\n  /** 组件传值  */\r\n  props: {\r\n    id: {\r\n      type: String,\r\n      required: true\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      loopCharacteristics: \"\",\r\n      loopInstanceForm: {},\r\n      multiLoopInstance: {},\r\n      defaultLoopInstanceForm: {\r\n        completionCondition: \"\",\r\n        loopCardinality: \"\",\r\n        extensionElements: [],\r\n        asyncAfter: false,\r\n        asyncBefore: false,\r\n        exclusive: false\r\n      },\r\n    }\r\n  },\r\n\r\n  /** 传值监听 */\r\n  watch: {\r\n    id: {\r\n      handler(newVal) {\r\n        if (StrUtil.isNotBlank(newVal)) {\r\n          this.getElementLoop(this.modelerStore.element.businessObject);        }\r\n      },\r\n      immediate: true, // 立即生效\r\n    },\r\n  },\r\n  created() {\r\n\r\n  },\r\n  methods: {\r\n    // 方法区\r\n    getElementLoop(businessObject) {\r\n      if (!businessObject.loopCharacteristics) {\r\n        this.loopCharacteristics = \"Null\";\r\n        this.loopInstanceForm = {};\r\n        return;\r\n      }\r\n      if (businessObject.loopCharacteristics.$type === \"bpmn:StandardLoopCharacteristics\") {\r\n        this.loopCharacteristics = \"StandardLoop\";\r\n        this.loopInstanceForm = {};\r\n        return;\r\n      }\r\n      if (businessObject.loopCharacteristics.isSequential) {\r\n        this.loopCharacteristics = \"SequentialMultiInstance\";\r\n      } else {\r\n        this.loopCharacteristics = \"ParallelMultiInstance\";\r\n      }\r\n      // 合并配置\r\n      this.loopInstanceForm = {\r\n        ...this.defaultLoopInstanceForm,\r\n        ...businessObject.loopCharacteristics,\r\n        completionCondition: businessObject.loopCharacteristics?.completionCondition?.body ?? \"\",\r\n        loopCardinality: businessObject.loopCharacteristics?.loopCardinality?.body ?? \"\"\r\n      };\r\n      // 保留当前元素 businessObject 上的 loopCharacteristics 实例\r\n      this.multiLoopInstance = this.modelerStore.element.businessObject.loopCharacteristics;\r\n      // 更新表单\r\n      if (\r\n        businessObject.loopCharacteristics.extensionElements &&\r\n        businessObject.loopCharacteristics.extensionElements.values &&\r\n        businessObject.loopCharacteristics.extensionElements.values.length\r\n      ) {\r\n        this.$set(this.loopInstanceForm, \"timeCycle\", businessObject.loopCharacteristics.extensionElements.values[0].body);\r\n      }\r\n    },\r\n\r\n    changeLoopCharacteristicsType(type) {\r\n      // 切换类型取消原表单配置\r\n      this.loopInstanceForm = {...this.defaultLoopInstanceForm};\r\n      // 取消多实例配置\r\n      if (type === \"Null\") {\r\n        this.modelerStore.modeling.updateProperties(this.modelerStore.element, {loopCharacteristics: null});\r\n        return;\r\n      }\r\n      // 配置循环\r\n      if (type === \"StandardLoop\") {\r\n        const loopCharacteristicsObject = this.modelerStore.moddle.create(\"bpmn:StandardLoopCharacteristics\");\r\n        this.modelerStore.modeling.updateProperties(this.modelerStore.element, {\r\n          loopCharacteristics: loopCharacteristicsObject\r\n        });\r\n        this.multiLoopInstance = null;\r\n        return;\r\n      }\r\n      // 时序\r\n      if (type === \"SequentialMultiInstance\") {\r\n        this.multiLoopInstance = this.modelerStore.moddle.create(\"bpmn:MultiInstanceLoopCharacteristics\", {\r\n          isSequential: true\r\n        });\r\n      } else {\r\n        this.multiLoopInstance = this.modelerStore.moddle.create(\"bpmn:MultiInstanceLoopCharacteristics\");\r\n      }\r\n      this.modelerStore.modeling.updateProperties(this.modelerStore.element, {\r\n        loopCharacteristics: this.multiLoopInstance\r\n      });\r\n    },\r\n\r\n    // 循环基数\r\n    updateLoopCardinality(cardinality) {\r\n      let loopCardinality = null;\r\n      if (cardinality && cardinality.length) {\r\n        loopCardinality = this.modelerStore.moddle.create(\"bpmn:FormalExpression\", {body: cardinality});\r\n      }\r\n      this.modelerStore.modeling.updateModdleProperties(this.modelerStore.element, this.multiLoopInstance, {\r\n        loopCardinality\r\n      });\r\n    },\r\n\r\n    // 完成条件\r\n    updateLoopCondition(condition) {\r\n      let completionCondition = null;\r\n      if (condition && condition.length) {\r\n        completionCondition = this.modelerStore.moddle.create(\"bpmn:FormalExpression\", {body: condition});\r\n      }\r\n      this.modelerStore.modeling.updateModdleProperties(this.modelerStore.element, this.multiLoopInstance, {\r\n        completionCondition\r\n      });\r\n    },\r\n\r\n    // 重试周期\r\n    updateLoopTimeCycle(timeCycle) {\r\n      const extensionElements = this.modelerStore.moddle.create(\"bpmn:ExtensionElements\", {\r\n        values: [\r\n          this.modelerStore.moddle.create(`flowable:FailedJobRetryTimeCycle`, {\r\n            body: timeCycle\r\n          })\r\n        ]\r\n      });\r\n      this.modelerStore.modeling.updateModdleProperties(this.modelerStore.element, this.multiLoopInstance, {\r\n        extensionElements\r\n      });\r\n    },\r\n\r\n    // 直接更新的基础信息\r\n    updateLoopBase() {\r\n      this.modelerStore.modeling.updateModdleProperties(this.modelerStore.element, this.multiLoopInstance, {\r\n        collection: this.loopInstanceForm.collection || null,\r\n        elementVariable: this.loopInstanceForm.elementVariable || null\r\n      });\r\n    },\r\n\r\n    // 各异步状态\r\n    updateLoopAsync(key) {\r\n      const {asyncBefore, asyncAfter} = this.loopInstanceForm;\r\n      let asyncAttr = Object.create(null);\r\n      if (!asyncBefore && !asyncAfter) {\r\n        this.$set(this.loopInstanceForm, \"exclusive\", false);\r\n        asyncAttr = {asyncBefore: false, asyncAfter: false, exclusive: false, extensionElements: null};\r\n      } else {\r\n        asyncAttr[key] = this.loopInstanceForm[key];\r\n      }\r\n      this.modelerStore.modeling.updateModdleProperties(this.modelerStore.element, this.multiLoopInstance, asyncAttr);\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n<style lang=\"scss\">\r\n@import '../style/process-panel';\r\n</style>\r\n\r\n"]}]}