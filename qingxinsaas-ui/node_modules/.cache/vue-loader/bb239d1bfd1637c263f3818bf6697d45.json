{"remainingRequest":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\components\\Process\\designer.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\components\\Process\\designer.vue","mtime":1733705220387},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRXhlY3V0aW9uTGlzdGVuZXIgZnJvbSAnLi9wYW5lbC9leGVjdXRpb25MaXN0ZW5lcicNCmltcG9ydCBUYXNrTGlzdGVuZXIgZnJvbSAnLi9wYW5lbC90YXNrTGlzdGVuZXInDQppbXBvcnQgTXVsdGlJbnN0YW5jZSBmcm9tICcuL3BhbmVsL211bHRpSW5zdGFuY2UnDQppbXBvcnQgQ29tbW9uUGFuZWwgZnJvbSAnLi9wYW5lbC9jb21tb25QYW5lbCcNCmltcG9ydCBVc2VyVGFza1BhbmVsIGZyb20gJy4vcGFuZWwvdGFza1BhbmVsJw0KaW1wb3J0IENvbmRpdGlvblBhbmVsIGZyb20gJy4vcGFuZWwvY29uZGl0aW9uUGFuZWwnDQppbXBvcnQgRm9ybVBhbmVsIGZyb20gJy4vcGFuZWwvZm9ybVBhbmVsJw0KaW1wb3J0IE90aGVyUGFuZWwgZnJvbSAnLi9wYW5lbC9vdGhlclBhbmVsJw0KaW1wb3J0IFByb3BlcnRpZXNQYW5lbCBmcm9tICcuL3BhbmVsL1Byb3BlcnRpZXNQYW5lbCcNCg0KaW1wb3J0IHsgdHJhbnNsYXRlTm9kZU5hbWUgfSBmcm9tICIuL2NvbW1vbi9icG1uVXRpbHMiOw0KaW1wb3J0IEZsb3dVc2VyIGZyb20gIkAvY29tcG9uZW50cy9mbG93L1VzZXIvaW5kZXgudnVlIjsNCmltcG9ydCBGbG93Um9sZSBmcm9tICJAL2NvbXBvbmVudHMvZmxvdy9Sb2xlL2luZGV4LnZ1ZSI7DQppbXBvcnQgRmxvd0V4cCBmcm9tICJAL2NvbXBvbmVudHMvZmxvdy9FeHByZXNzaW9uL2luZGV4LnZ1ZSI7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJEZXNpZ25lciIsDQogIGNvbXBvbmVudHM6IHsNCiAgICBFeGVjdXRpb25MaXN0ZW5lciwNCiAgICBUYXNrTGlzdGVuZXIsDQogICAgTXVsdGlJbnN0YW5jZSwNCiAgICBDb21tb25QYW5lbCwNCiAgICBVc2VyVGFza1BhbmVsLA0KICAgIENvbmRpdGlvblBhbmVsLA0KICAgIEZvcm1QYW5lbCwNCiAgICBPdGhlclBhbmVsLA0KICAgIFByb3BlcnRpZXNQYW5lbCwNCiAgICBGbG93VXNlciwNCiAgICBGbG93Um9sZSwNCiAgICBGbG93RXhwLA0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBhY3RpdmVOYW1lIDogJ2NvbW1vbicsDQogICAgICBleGVjdXRpb25MaXN0ZW5lckNvdW50OiAwLA0KICAgICAgdGFza0xpc3RlbmVyQ291bnQ6MCwNCiAgICAgIGVsZW1lbnRJZDoiIiwNCiAgICAgIGVsZW1lbnRUeXBlOiIiLA0KICAgICAgY29uZGl0aW9uVmlzaWJsZTpmYWxzZSwvLyDmtYHovazmnaHku7borr7nva4NCiAgICAgIGZvcm1WaXNpYmxlOmZhbHNlLCAvLyDooajljZXphY3nva4NCiAgICAgIHJ1bGVzOnsNCiAgICAgICAgaWQ6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6IqC54K5SWQg5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgIF0sDQogICAgICAgIG5hbWU6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6IqC54K55ZCN56ew5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgIF0sDQogICAgICB9LA0KICAgIH0NCiAgfSwNCg0KICAvKiog5Lyg5YC855uR5ZCsICovDQogIHdhdGNoOiB7DQogICAgZWxlbWVudElkOiB7DQogICAgICBoYW5kbGVyKCkgew0KICAgICAgICB0aGlzLmFjdGl2ZU5hbWUgPSAiY29tbW9uIjsNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuaW5pdE1vZGVscygpOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g5Yid5aeL5YyW5rWB56iL6K6+6K6h5ZmoDQogICAgaW5pdE1vZGVscygpIHsNCiAgICAgIHRoaXMuZ2V0QWN0aXZlRWxlbWVudCgpOw0KICAgIH0sDQoNCiAgICAvLyDms6jlhozoioLngrnkuovku7YNCiAgICBnZXRBY3RpdmVFbGVtZW50KCkgew0KICAgICAgLy8g5Yid5aeL56ys5LiA5Liq6YCJ5Lit5YWD57SgIGJwbW46UHJvY2Vzcw0KICAgICAgdGhpcy5pbml0Rm9ybU9uQ2hhbmdlZChudWxsKTsNCiAgICAgIHRoaXMubW9kZWxlclN0b3JlLm1vZGVsZXIub24oImltcG9ydC5kb25lIiwgZSA9PiB7DQogICAgICAgIHRoaXMuaW5pdEZvcm1PbkNoYW5nZWQobnVsbCk7DQogICAgICB9KTsNCiAgICAgIC8vIOebkeWQrOmAieaLqeS6i+S7tu+8jOS/ruaUueW9k+WJjea/gOa0u+eahOWFg+e0oOS7peWPiuihqOWNlQ0KICAgICAgdGhpcy5tb2RlbGVyU3RvcmUubW9kZWxlci5vbigic2VsZWN0aW9uLmNoYW5nZWQiLCAoe25ld1NlbGVjdGlvbn0pID0+IHsNCiAgICAgICAgdGhpcy5pbml0Rm9ybU9uQ2hhbmdlZChuZXdTZWxlY3Rpb25bMF0gfHwgbnVsbCk7DQogICAgICB9KTsNCiAgICAgIHRoaXMubW9kZWxlclN0b3JlLm1vZGVsZXIub24oImVsZW1lbnQuY2hhbmdlZCIsICh7ZWxlbWVudH0pID0+IHsNCiAgICAgICAgLy8g5L+d6K+BIOS/ruaUuSAi6buY6K6k5rWB6L2s6Lev5b6EIiDnsbvkvLzpnIDopoHkv67mlLnlpJrkuKrlhYPntKDnmoTkuovku7blj5HnlJ/nmoTml7blgJnvvIzmm7TmlrDooajljZXnmoTlhYPntKDkuI7ljp/pgInkuK3lhYPntKDkuI3kuIDoh7TjgIINCiAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5pZCA9PT0gdGhpcy5lbGVtZW50SWQpIHsNCiAgICAgICAgICB0aGlzLmluaXRGb3JtT25DaGFuZ2VkKGVsZW1lbnQpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgLy8g5Yid5aeL5YyW5pWw5o2uDQogICAgaW5pdEZvcm1PbkNoYW5nZWQoZWxlbWVudCkgew0KICAgICAgbGV0IGFjdGl2YXRlZEVsZW1lbnQgPSBlbGVtZW50Ow0KICAgICAgaWYgKCFhY3RpdmF0ZWRFbGVtZW50KSB7DQogICAgICAgIGFjdGl2YXRlZEVsZW1lbnQgPQ0KICAgICAgICAgIHRoaXMubW9kZWxlclN0b3JlLmVsUmVnaXN0cnkuZmluZChlbCA9PiBlbC50eXBlID09PSAiYnBtbjpQcm9jZXNzIikgPz8NCiAgICAgICAgICB0aGlzLm1vZGVsZXJTdG9yZS5lbFJlZ2lzdHJ5LmZpbmQoZWwgPT4gZWwudHlwZSA9PT0gImJwbW46Q29sbGFib3JhdGlvbiIpOw0KICAgICAgfQ0KICAgICAgaWYgKCFhY3RpdmF0ZWRFbGVtZW50KSByZXR1cm47DQogICAgICB0aGlzLm1vZGVsZXJTdG9yZS5lbGVtZW50ID0gYWN0aXZhdGVkRWxlbWVudDsNCiAgICAgIHRoaXMuZWxlbWVudElkID0gYWN0aXZhdGVkRWxlbWVudC5pZDsNCiAgICAgIHRoaXMuZWxlbWVudFR5cGUgPSBhY3RpdmF0ZWRFbGVtZW50LnR5cGUuc3BsaXQoIjoiKVsxXSB8fCAiIjsNCiAgICAgIHRoaXMuY29uZGl0aW9uVmlzaWJsZSA9ICEhKA0KICAgICAgICB0aGlzLmVsZW1lbnRUeXBlID09PSAiU2VxdWVuY2VGbG93IiAmJg0KICAgICAgICBhY3RpdmF0ZWRFbGVtZW50LnNvdXJjZSAmJg0KICAgICAgICBhY3RpdmF0ZWRFbGVtZW50LnNvdXJjZS50eXBlLmluZGV4T2YoIlN0YXJ0RXZlbnQiKSA9PT0gLTENCiAgICAgICk7DQogICAgICB0aGlzLmZvcm1WaXNpYmxlID0gdGhpcy5lbGVtZW50VHlwZSA9PT0gIlVzZXJUYXNrIiB8fCB0aGlzLmVsZW1lbnRUeXBlID09PSAiU3RhcnRFdmVudCI7DQogICAgfSwNCg0KICAgIC8qKiDojrflj5bmiafooYznm5HlkKzlmajmlbDph48gKi8NCiAgICBnZXRFeGVjdXRpb25MaXN0ZW5lckNvdW50KHZhbHVlKSB7DQogICAgICB0aGlzLmV4ZWN1dGlvbkxpc3RlbmVyQ291bnQgPSB2YWx1ZTsNCiAgICB9LA0KICAgIC8qKiDojrflj5bku7vliqHnm5HlkKzlmajmlbDph48gKi8NCiAgICBnZXRUYXNrTGlzdGVuZXJDb3VudCh2YWx1ZSkgew0KICAgICAgdGhpcy50YXNrTGlzdGVuZXJDb3VudCA9IHZhbHVlOw0KICAgIH0sDQogICAgdHJhbnNsYXRlTm9kZU5hbWUodmFsKXsNCiAgICAgIHJldHVybiB0cmFuc2xhdGVOb2RlTmFtZSh2YWwpOw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["designer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"designer.vue","sourceRoot":"src/components/Process","sourcesContent":["<template>\r\n  <div>\r\n    <template slot=\"header\">\r\n      <div class=\"card-header\">\r\n        <span>{{ translateNodeName(elementType) }}</span>\r\n      </div>\r\n    </template>\r\n    <el-collapse v-model=\"activeName\" >\r\n        <!--   常规信息     -->\r\n        <el-collapse-item name=\"common\">\r\n          <template slot=\"title\"><i class=\"el-icon-info\"></i> 常规信息</template>\r\n          <common-panel :id=\"elementId\"/>\r\n        </el-collapse-item>\r\n\r\n        <!--   任务信息     -->\r\n        <el-collapse-item name=\"Task\" v-if=\"elementType.indexOf('Task') !== -1\">\r\n          <template slot=\"title\"><i class=\"el-icon-s-claim\"></i> 任务配置</template>\r\n          <user-task-panel :id=\"elementId\"/>\r\n        </el-collapse-item>\r\n\r\n        <!--   表单     -->\r\n        <el-collapse-item name=\"form\" v-if=\"formVisible\">\r\n          <template slot=\"title\"><i class=\"el-icon-s-order\"></i> 表单配置</template>\r\n          <form-panel :id=\"elementId\"/>\r\n        </el-collapse-item>\r\n\r\n        <!--   执行监听器     -->\r\n        <el-collapse-item name=\"executionListener\">\r\n          <template slot=\"title\"><i class=\"el-icon-s-promotion\"></i> 执行监听器\r\n             <el-badge :value=\"executionListenerCount\" class=\"item\" type=\"primary\"/>\r\n           </template>\r\n          <execution-listener :id=\"elementId\" @getExecutionListenerCount=\"getExecutionListenerCount\"/>\r\n        </el-collapse-item>\r\n\r\n        <!--   任务监听器     -->\r\n        <el-collapse-item name=\"taskListener\" v-if=\"elementType === 'UserTask'\" >\r\n          <template slot=\"title\"><i class=\"el-icon-s-flag\"></i> 任务监听器\r\n            <el-badge :value=\"taskListenerCount\" class=\"item\" type=\"primary\"/>\r\n          </template>\r\n          <task-listener :id=\"elementId\" @getTaskListenerCount=\"getTaskListenerCount\"/>\r\n        </el-collapse-item>\r\n\r\n        <!--   多实例     -->\r\n        <el-collapse-item name=\"multiInstance\" v-if=\"elementType.indexOf('Task') !== -1\" >\r\n          <template slot=\"title\"><i class=\"el-icon-s-grid\"></i> 多实例</template>\r\n          <multi-instance :id=\"elementId\"/>\r\n        </el-collapse-item>\r\n        <!--   流转条件     -->\r\n        <el-collapse-item name=\"condition\" v-if=\"conditionVisible\" >\r\n          <template slot=\"title\"><i class=\"el-icon-share\"></i> 流转条件</template>\r\n          <condition-panel :id=\"elementId\"/>\r\n        </el-collapse-item>\r\n\r\n        <!--   扩展属性     -->\r\n        <el-collapse-item name=\"properties\" >\r\n          <template slot=\"title\"><i class=\"el-icon-circle-plus\"></i> 扩展属性</template>\r\n          <properties-panel :id=\"elementId\"/>\r\n        </el-collapse-item>\r\n\r\n    </el-collapse>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ExecutionListener from './panel/executionListener'\r\nimport TaskListener from './panel/taskListener'\r\nimport MultiInstance from './panel/multiInstance'\r\nimport CommonPanel from './panel/commonPanel'\r\nimport UserTaskPanel from './panel/taskPanel'\r\nimport ConditionPanel from './panel/conditionPanel'\r\nimport FormPanel from './panel/formPanel'\r\nimport OtherPanel from './panel/otherPanel'\r\nimport PropertiesPanel from './panel/PropertiesPanel'\r\n\r\nimport { translateNodeName } from \"./common/bpmnUtils\";\r\nimport FlowUser from \"@/components/flow/User/index.vue\";\r\nimport FlowRole from \"@/components/flow/Role/index.vue\";\r\nimport FlowExp from \"@/components/flow/Expression/index.vue\";\r\nexport default {\r\n  name: \"Designer\",\r\n  components: {\r\n    ExecutionListener,\r\n    TaskListener,\r\n    MultiInstance,\r\n    CommonPanel,\r\n    UserTaskPanel,\r\n    ConditionPanel,\r\n    FormPanel,\r\n    OtherPanel,\r\n    PropertiesPanel,\r\n    FlowUser,\r\n    FlowRole,\r\n    FlowExp,\r\n  },\r\n  data() {\r\n    return {\r\n      activeName : 'common',\r\n      executionListenerCount: 0,\r\n      taskListenerCount:0,\r\n      elementId:\"\",\r\n      elementType:\"\",\r\n      conditionVisible:false,// 流转条件设置\r\n      formVisible:false, // 表单配置\r\n      rules:{\r\n        id: [\r\n          { required: true, message: '节点Id 不能为空', trigger: 'blur' },\r\n        ],\r\n        name: [\r\n          { required: true, message: '节点名称不能为空', trigger: 'blur' },\r\n        ],\r\n      },\r\n    }\r\n  },\r\n\r\n  /** 传值监听 */\r\n  watch: {\r\n    elementId: {\r\n      handler() {\r\n        this.activeName = \"common\";\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.initModels();\r\n  },\r\n  methods: {\r\n    // 初始化流程设计器\r\n    initModels() {\r\n      this.getActiveElement();\r\n    },\r\n\r\n    // 注册节点事件\r\n    getActiveElement() {\r\n      // 初始第一个选中元素 bpmn:Process\r\n      this.initFormOnChanged(null);\r\n      this.modelerStore.modeler.on(\"import.done\", e => {\r\n        this.initFormOnChanged(null);\r\n      });\r\n      // 监听选择事件，修改当前激活的元素以及表单\r\n      this.modelerStore.modeler.on(\"selection.changed\", ({newSelection}) => {\r\n        this.initFormOnChanged(newSelection[0] || null);\r\n      });\r\n      this.modelerStore.modeler.on(\"element.changed\", ({element}) => {\r\n        // 保证 修改 \"默认流转路径\" 类似需要修改多个元素的事件发生的时候，更新表单的元素与原选中元素不一致。\r\n        if (element && element.id === this.elementId) {\r\n          this.initFormOnChanged(element);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 初始化数据\r\n    initFormOnChanged(element) {\r\n      let activatedElement = element;\r\n      if (!activatedElement) {\r\n        activatedElement =\r\n          this.modelerStore.elRegistry.find(el => el.type === \"bpmn:Process\") ??\r\n          this.modelerStore.elRegistry.find(el => el.type === \"bpmn:Collaboration\");\r\n      }\r\n      if (!activatedElement) return;\r\n      this.modelerStore.element = activatedElement;\r\n      this.elementId = activatedElement.id;\r\n      this.elementType = activatedElement.type.split(\":\")[1] || \"\";\r\n      this.conditionVisible = !!(\r\n        this.elementType === \"SequenceFlow\" &&\r\n        activatedElement.source &&\r\n        activatedElement.source.type.indexOf(\"StartEvent\") === -1\r\n      );\r\n      this.formVisible = this.elementType === \"UserTask\" || this.elementType === \"StartEvent\";\r\n    },\r\n\r\n    /** 获取执行监听器数量 */\r\n    getExecutionListenerCount(value) {\r\n      this.executionListenerCount = value;\r\n    },\r\n    /** 获取任务监听器数量 */\r\n    getTaskListenerCount(value) {\r\n      this.taskListenerCount = value;\r\n    },\r\n    translateNodeName(val){\r\n      return translateNodeName(val);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n</style>\r\n"]}]}