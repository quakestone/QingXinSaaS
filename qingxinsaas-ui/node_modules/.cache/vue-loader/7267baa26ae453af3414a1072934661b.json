{"remainingRequest":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\components\\tinymce\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\components\\tinymce\\index.vue","mtime":1733705220437},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KDQppbXBvcnQgbG9hZFRpbnltY2UgZnJvbSAnQC91dGlscy9sb2FkVGlueW1jZScNCmltcG9ydCB7IHBsdWdpbnMsIHRvb2xiYXIgfSBmcm9tICcuL2NvbmZpZycNCmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSAndGhyb3R0bGUtZGVib3VuY2UnDQoNCmxldCBudW0gPSAxDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgcHJvcHM6IHsNCiAgICBpZDogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgZGVmYXVsdDogKCkgPT4gew0KICAgICAgICBudW0gPT09IDEwMDAwICYmIChudW0gPSAxKQ0KICAgICAgICByZXR1cm4gYHRpbnltY2UkeytuZXcgRGF0ZSgpfSR7bnVtKyt9YA0KICAgICAgfQ0KICAgIH0sDQogICAgdmFsdWU6IHsNCiAgICAgIGRlZmF1bHQ6ICcnDQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB0aW55bWNlSWQ6IHRoaXMuaWQNCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgbG9hZFRpbnltY2UodGlueW1jZSA9PiB7DQogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZ2xvYmFsLXJlcXVpcmUNCiAgICAgIHJlcXVpcmUoJy4vemhfQ04nKQ0KICAgICAgbGV0IGNvbmYgPSB7DQogICAgICAgIHNlbGVjdG9yOiBgIyR7dGhpcy50aW55bWNlSWR9YCwNCiAgICAgICAgbGFuZ3VhZ2U6ICd6aF9DTicsDQogICAgICAgIG1lbnViYXI6ICdmaWxlIGVkaXQgaW5zZXJ0IHZpZXcgZm9ybWF0IHRhYmxlJywNCiAgICAgICAgcGx1Z2lucywNCiAgICAgICAgdG9vbGJhciwNCiAgICAgICAgaGVpZ2h0OiAzMDAsDQogICAgICAgIGJyYW5kaW5nOiBmYWxzZSwNCiAgICAgICAgb2JqZWN0X3Jlc2l6aW5nOiBmYWxzZSwNCiAgICAgICAgZW5kX2NvbnRhaW5lcl9vbl9lbXB0eV9ibG9jazogdHJ1ZSwNCiAgICAgICAgcG93ZXJwYXN0ZV93b3JkX2ltcG9ydDogJ2NsZWFuJywNCiAgICAgICAgY29kZV9kaWFsb2dfaGVpZ2h0OiA0NTAsDQogICAgICAgIGNvZGVfZGlhbG9nX3dpZHRoOiAxMDAwLA0KICAgICAgICBhZHZsaXN0X2J1bGxldF9zdHlsZXM6ICdzcXVhcmUnLA0KICAgICAgICBhZHZsaXN0X251bWJlcl9zdHlsZXM6ICdkZWZhdWx0JywNCiAgICAgICAgZGVmYXVsdF9saW5rX3RhcmdldDogJ19ibGFuaycsDQogICAgICAgIGxpbmtfdGl0bGU6IGZhbHNlLA0KICAgICAgICBub25icmVha2luZ19mb3JjZV90YWI6IHRydWUNCiAgICAgIH0NCiAgICAgIGNvbmYgPSBPYmplY3QuYXNzaWduKGNvbmYsIHRoaXMuJGF0dHJzKQ0KICAgICAgY29uZi5pbml0X2luc3RhbmNlX2NhbGxiYWNrID0gZWRpdG9yID0+IHsNCiAgICAgICAgaWYgKHRoaXMudmFsdWUpIGVkaXRvci5zZXRDb250ZW50KHRoaXMudmFsdWUpDQogICAgICAgIHRoaXMudk1vZGVsKGVkaXRvcikNCiAgICAgIH0NCiAgICAgIHRpbnltY2UuaW5pdChjb25mKQ0KICAgIH0pDQogIH0sDQogIGRlc3Ryb3llZCgpIHsNCiAgICB0aGlzLmRlc3Ryb3lUaW55bWNlKCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHZNb2RlbChlZGl0b3IpIHsNCiAgICAgIC8vIOaOp+WItui/nue7reWGmeWFpeaXtnNldENvbnRlbnTnmoTop6blj5HpopHnjocNCiAgICAgIGNvbnN0IGRlYm91bmNlU2V0Q29udGVudCA9IGRlYm91bmNlKDI1MCwgZWRpdG9yLnNldENvbnRlbnQpDQogICAgICB0aGlzLiR3YXRjaCgndmFsdWUnLCAodmFsLCBwcmV2VmFsKSA9PiB7DQogICAgICAgIGlmIChlZGl0b3IgJiYgdmFsICE9PSBwcmV2VmFsICYmIHZhbCAhPT0gZWRpdG9yLmdldENvbnRlbnQoKSkgew0KICAgICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnc3RyaW5nJykgdmFsID0gdmFsLnRvU3RyaW5nKCkNCiAgICAgICAgICBkZWJvdW5jZVNldENvbnRlbnQuY2FsbChlZGl0b3IsIHZhbCkNCiAgICAgICAgfQ0KICAgICAgfSkNCg0KICAgICAgZWRpdG9yLm9uKCdjaGFuZ2Uga2V5dXAgdW5kbyByZWRvJywgKCkgPT4gew0KICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIGVkaXRvci5nZXRDb250ZW50KCkpDQogICAgICB9KQ0KICAgIH0sDQogICAgZGVzdHJveVRpbnltY2UoKSB7DQogICAgICBpZiAoIXdpbmRvdy50aW55bWNlKSByZXR1cm4NCiAgICAgIGNvbnN0IHRpbnltY2UgPSB3aW5kb3cudGlueW1jZS5nZXQodGhpcy50aW55bWNlSWQpDQogICAgICBpZiAodGlueW1jZSkgew0KICAgICAgICB0aW55bWNlLmRlc3Ryb3koKQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/tinymce","sourcesContent":["<template>\r\n  <textarea :id=\"tinymceId\" style=\"visibility: hidden\" />\r\n</template>\r\n\r\n<script>\r\nimport loadTinymce from '@/utils/loadTinymce'\r\nimport { plugins, toolbar } from './config'\r\nimport { debounce } from 'throttle-debounce'\r\n\r\nlet num = 1\r\n\r\nexport default {\r\n  props: {\r\n    id: {\r\n      type: String,\r\n      default: () => {\r\n        num === 10000 && (num = 1)\r\n        return `tinymce${+new Date()}${num++}`\r\n      }\r\n    },\r\n    value: {\r\n      default: ''\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      tinymceId: this.id\r\n    }\r\n  },\r\n  mounted() {\r\n    loadTinymce(tinymce => {\r\n      // eslint-disable-next-line global-require\r\n      require('./zh_CN')\r\n      let conf = {\r\n        selector: `#${this.tinymceId}`,\r\n        language: 'zh_CN',\r\n        menubar: 'file edit insert view format table',\r\n        plugins,\r\n        toolbar,\r\n        height: 300,\r\n        branding: false,\r\n        object_resizing: false,\r\n        end_container_on_empty_block: true,\r\n        powerpaste_word_import: 'clean',\r\n        code_dialog_height: 450,\r\n        code_dialog_width: 1000,\r\n        advlist_bullet_styles: 'square',\r\n        advlist_number_styles: 'default',\r\n        default_link_target: '_blank',\r\n        link_title: false,\r\n        nonbreaking_force_tab: true\r\n      }\r\n      conf = Object.assign(conf, this.$attrs)\r\n      conf.init_instance_callback = editor => {\r\n        if (this.value) editor.setContent(this.value)\r\n        this.vModel(editor)\r\n      }\r\n      tinymce.init(conf)\r\n    })\r\n  },\r\n  destroyed() {\r\n    this.destroyTinymce()\r\n  },\r\n  methods: {\r\n    vModel(editor) {\r\n      // 控制连续写入时setContent的触发频率\r\n      const debounceSetContent = debounce(250, editor.setContent)\r\n      this.$watch('value', (val, prevVal) => {\r\n        if (editor && val !== prevVal && val !== editor.getContent()) {\r\n          if (typeof val !== 'string') val = val.toString()\r\n          debounceSetContent.call(editor, val)\r\n        }\r\n      })\r\n\r\n      editor.on('change keyup undo redo', () => {\r\n        this.$emit('input', editor.getContent())\r\n      })\r\n    },\r\n    destroyTinymce() {\r\n      if (!window.tinymce) return\r\n      const tinymce = window.tinymce.get(this.tinymceId)\r\n      if (tinymce) {\r\n        tinymce.destroy()\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}