{"remainingRequest":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\views\\flowable\\definition\\model.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\views\\flowable\\definition\\model.vue","mtime":1733705220542},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge3JlYWRYbWwsIHJvbGVMaXN0LCBzYXZlWG1sLCB1c2VyTGlzdCxleHBMaXN0fSBmcm9tICJAL2FwaS9mbG93YWJsZS9kZWZpbml0aW9uIjsNCmltcG9ydCBCcG1uTW9kZWwgZnJvbSAnQC9jb21wb25lbnRzL1Byb2Nlc3MnDQppbXBvcnQgdmtCZWF1dGlmeSBmcm9tICd2a2JlYXV0aWZ5Jw0KaW1wb3J0IGhsanMgZnJvbSAnaGlnaGxpZ2h0LmpzJw0KaW1wb3J0ICdoaWdobGlnaHQuanMvc3R5bGVzL2F0ZWxpZXItc2F2YW5uYS1kYXJrLmNzcycNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIk1vZGVsIiwNCiAgY29tcG9uZW50czogew0KICAgIEJwbW5Nb2RlbCwNCiAgICB2a0JlYXV0aWZ5DQogIH0sDQogIC8vIOiHquWumuS5ieaMh+S7pA0KICBkaXJlY3RpdmVzOiB7DQogICAgZGVlcDogdHJ1ZSwNCiAgICBoaWdobGlnaHQ6ew0KICAgICAgZGVlcDogdHJ1ZSwNCiAgICAgIGJpbmQ6IGZ1bmN0aW9uIGJpbmQoZWwsIGJpbmRpbmcpIHsNCiAgICAgICAgY29uc3QgdGFyZ2V0cyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2NvZGUnKTsNCiAgICAgICAgbGV0IHRhcmdldDsNCiAgICAgICAgbGV0IGk7DQogICAgICAgIGZvciAoaSA9IDA7IGkgPCB0YXJnZXRzLmxlbmd0aDsgaSArPSAxKSB7DQogICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0c1tpXTsNCiAgICAgICAgICBpZiAodHlwZW9mIGJpbmRpbmcudmFsdWUgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICB0YXJnZXQudGV4dENvbnRlbnQgPSBiaW5kaW5nLnZhbHVlOw0KICAgICAgICAgIH0NCiAgICAgICAgICBobGpzLmhpZ2hsaWdodEJsb2NrKHRhcmdldCk7DQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICBjb21wb25lbnRVcGRhdGVkOiBmdW5jdGlvbiBjb21wb25lbnRVcGRhdGVkKGVsLCBiaW5kaW5nKSB7DQogICAgICAgIGNvbnN0IHRhcmdldHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdjb2RlJyk7DQogICAgICAgIGxldCB0YXJnZXQ7DQogICAgICAgIGxldCBpOw0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkgKz0gMSkgew0KICAgICAgICAgIHRhcmdldCA9IHRhcmdldHNbaV07DQogICAgICAgICAgaWYgKHR5cGVvZiBiaW5kaW5nLnZhbHVlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdGFyZ2V0LnRleHRDb250ZW50ID0gYmluZGluZy52YWx1ZTsNCiAgICAgICAgICAgIGhsanMuaGlnaGxpZ2h0QmxvY2sodGFyZ2V0KTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0sDQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB4bWw6ICIiLCAvLyDlkI7nq6/mn6Xor6LliLDnmoR4bWwNCiAgICAgIG1vZGVsZXI6IiIsDQogICAgICBkYXRhRXhpdDogZmFsc2UsDQogICAgICB4bWxPcGVuOiBmYWxzZSwNCiAgICAgIHhtbFRpdGxlOiAnJywNCiAgICAgIHhtbERhdGE6ICcnLA0KICAgIH07DQogIH0sDQogIGNyZWF0ZWQgKCkgew0KICAgIGNvbnN0IGRlcGxveUlkID0gdGhpcy4kcm91dGUucXVlcnkgJiYgdGhpcy4kcm91dGUucXVlcnkuZGVwbG95SWQ7DQogICAgLy8gIOafpeivoua1geeoi3htbA0KICAgIGlmIChkZXBsb3lJZCkgew0KICAgICAgdGhpcy5nZXRYbWxEYXRhKGRlcGxveUlkKTsNCiAgICB9DQogICAgdGhpcy5nZXREYXRhTGlzdCgpDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvKiogeG1sIOaWh+S7tiAqLw0KICAgIGdldFhtbERhdGEoZGVwbG95SWQpIHsNCiAgICAgIC8vIOWPkemAgeivt+axgu+8jOiOt+WPlnhtbA0KICAgICAgcmVhZFhtbChkZXBsb3lJZCkudGhlbihyZXMgPT57DQogICAgICAgIHRoaXMueG1sID0gcmVzLmRhdGE7DQogICAgICAgIHRoaXMubW9kZWxlciA9IHJlcy5kYXRhDQogICAgICB9KQ0KICAgIH0sDQogICAgLyoqIOS/neWtmHhtbCAqLw0KICAgIHNhdmUoZGF0YSkgew0KICAgICAgY29uc3QgcGFyYW1zID0gew0KICAgICAgICBuYW1lOiBkYXRhLnByb2Nlc3MubmFtZSwNCiAgICAgICAgY2F0ZWdvcnk6IGRhdGEucHJvY2Vzcy5jYXRlZ29yeSwNCiAgICAgICAgeG1sOiBkYXRhLnhtbA0KICAgICAgfQ0KICAgICAgc2F2ZVhtbChwYXJhbXMpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy4kbW9kYWwubXNnU3VjY2VzcyhyZXMubXNnKQ0KICAgICAgICAvLyDlhbPpl63lvZPliY3moIfnrb7pobXlubbov5Tlm57kuIrkuKrpobXpnaINCiAgICAgICAgY29uc3Qgb2JqID0geyBwYXRoOiAiL2Zsb3dhYmxlL2RlZmluaXRpb24iLCBxdWVyeTogeyB0OiBEYXRlLm5vdygpfSB9Ow0KICAgICAgICB0aGlzLiR0YWIuY2xvc2VPcGVuUGFnZShvYmopOw0KICAgICAgfSkNCiAgICB9LA0KICAgIC8qKiDmjIflrprmtYHnqIvlip7nkIbkurrlkZjliJfooaggKi8NCiAgICBnZXREYXRhTGlzdCgpIHsNCiAgICAgIHVzZXJMaXN0KCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLm1vZGVsZXJTdG9yZS51c2VyTGlzdCA9IHJlcy5kYXRhOw0KICAgICAgfSkNCiAgICAgIHJvbGVMaXN0KCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLm1vZGVsZXJTdG9yZS5yb2xlTGlzdCA9IHJlcy5kYXRhOw0KICAgICAgfSkNCiAgICAgIGV4cExpc3QoKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMubW9kZWxlclN0b3JlLmV4cExpc3QgPSByZXMuZGF0YTsNCiAgICAgICAgdGhpcy5kYXRhRXhpdCA9IHRydWU7DQogICAgICB9KTsNCiAgICB9LA0KICAgIC8qKiDlsZXnpLp4bWwgKi8NCiAgICBzaG93WE1MKHhtbERhdGEpew0KICAgICAgdGhpcy54bWxUaXRsZSA9ICd4bWzmn6XnnIsnOw0KICAgICAgdGhpcy54bWxPcGVuID0gdHJ1ZTsNCiAgICAgIHRoaXMueG1sRGF0YSA9IHZrQmVhdXRpZnkueG1sKHhtbERhdGEpOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["model.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"model.vue","sourceRoot":"src/views/flowable/definition","sourcesContent":["<template>\r\n  <div>\r\n    <bpmn-model\r\n      v-if=\"dataExit\"\r\n      :xml=\"xml\"\r\n      :is-view=\"false\"\r\n      @save=\"save\"\r\n      @showXML=\"showXML\"\r\n    />\r\n    <!--在线查看xml-->\r\n    <el-drawer :title=\"xmlTitle\" :modal=\"false\" direction=\"rtl\" :visible.sync=\"xmlOpen\" size=\"60%\">\r\n      <!-- 设置对话框内容高度 -->\r\n        <el-scrollbar>\r\n            <pre v-highlight=\"xmlData\"><code class=\"xml\"></code></pre>\r\n        </el-scrollbar>\r\n    </el-drawer>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {readXml, roleList, saveXml, userList,expList} from \"@/api/flowable/definition\";\r\nimport BpmnModel from '@/components/Process'\r\nimport vkBeautify from 'vkbeautify'\r\nimport hljs from 'highlight.js'\r\nimport 'highlight.js/styles/atelier-savanna-dark.css'\r\nexport default {\r\n  name: \"Model\",\r\n  components: {\r\n    BpmnModel,\r\n    vkBeautify\r\n  },\r\n  // 自定义指令\r\n  directives: {\r\n    deep: true,\r\n    highlight:{\r\n      deep: true,\r\n      bind: function bind(el, binding) {\r\n        const targets = el.querySelectorAll('code');\r\n        let target;\r\n        let i;\r\n        for (i = 0; i < targets.length; i += 1) {\r\n          target = targets[i];\r\n          if (typeof binding.value === 'string') {\r\n            target.textContent = binding.value;\r\n          }\r\n          hljs.highlightBlock(target);\r\n        }\r\n      },\r\n      componentUpdated: function componentUpdated(el, binding) {\r\n        const targets = el.querySelectorAll('code');\r\n        let target;\r\n        let i;\r\n        for (i = 0; i < targets.length; i += 1) {\r\n          target = targets[i];\r\n          if (typeof binding.value === 'string') {\r\n            target.textContent = binding.value;\r\n            hljs.highlightBlock(target);\r\n          }\r\n        }\r\n      },\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      xml: \"\", // 后端查询到的xml\r\n      modeler:\"\",\r\n      dataExit: false,\r\n      xmlOpen: false,\r\n      xmlTitle: '',\r\n      xmlData: '',\r\n    };\r\n  },\r\n  created () {\r\n    const deployId = this.$route.query && this.$route.query.deployId;\r\n    //  查询流程xml\r\n    if (deployId) {\r\n      this.getXmlData(deployId);\r\n    }\r\n    this.getDataList()\r\n  },\r\n  methods: {\r\n    /** xml 文件 */\r\n    getXmlData(deployId) {\r\n      // 发送请求，获取xml\r\n      readXml(deployId).then(res =>{\r\n        this.xml = res.data;\r\n        this.modeler = res.data\r\n      })\r\n    },\r\n    /** 保存xml */\r\n    save(data) {\r\n      const params = {\r\n        name: data.process.name,\r\n        category: data.process.category,\r\n        xml: data.xml\r\n      }\r\n      saveXml(params).then(res => {\r\n        this.$modal.msgSuccess(res.msg)\r\n        // 关闭当前标签页并返回上个页面\r\n        const obj = { path: \"/flowable/definition\", query: { t: Date.now()} };\r\n        this.$tab.closeOpenPage(obj);\r\n      })\r\n    },\r\n    /** 指定流程办理人员列表 */\r\n    getDataList() {\r\n      userList().then(res => {\r\n        this.modelerStore.userList = res.data;\r\n      })\r\n      roleList().then(res => {\r\n        this.modelerStore.roleList = res.data;\r\n      })\r\n      expList().then(res => {\r\n        this.modelerStore.expList = res.data;\r\n        this.dataExit = true;\r\n      });\r\n    },\r\n    /** 展示xml */\r\n    showXML(xmlData){\r\n      this.xmlTitle = 'xml查看';\r\n      this.xmlOpen = true;\r\n      this.xmlData = vkBeautify.xml(xmlData);\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.content-box{\r\n  line-height: 10px;\r\n}\r\n// 修改对话框高度\r\n.showAll_dialog {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  overflow: hidden;\r\n  ::v-deep .el-dialog {\r\n    margin: 0 auto !important;\r\n    height: 80%;\r\n    overflow: hidden;\r\n    background-color: #ffffff;\r\n    .el-dialog__body {\r\n      position: absolute;\r\n      left: 0;\r\n      top: 54px;\r\n      bottom: 0;\r\n      right: 0;\r\n      z-index: 1;\r\n      overflow: hidden;\r\n      overflow-y: auto;\r\n      // 下边设置字体，我的需求是黑底白字\r\n      color: #ffffff;\r\n      padding: 0 15px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}