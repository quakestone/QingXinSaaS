{"remainingRequest":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\views\\tool\\build\\JsonDrawer.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\src\\views\\tool\\build\\JsonDrawer.vue","mtime":1733705220591},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\chenxi\\Desktop\\pro\\QingXinSaaS\\qingxinsaas-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBiZWF1dGlmaWVyQ29uZiB9IGZyb20gJ0AvdXRpbHMnDQppbXBvcnQgQ2xpcGJvYXJkSlMgZnJvbSAnY2xpcGJvYXJkJw0KaW1wb3J0IHsgc2F2ZUFzIH0gZnJvbSAnZmlsZS1zYXZlcicNCmltcG9ydCBsb2FkTW9uYWNvIGZyb20gJ0AvdXRpbHMvbG9hZE1vbmFjbycNCmltcG9ydCBsb2FkQmVhdXRpZmllciBmcm9tICdAL3V0aWxzL2xvYWRCZWF1dGlmaWVyJw0KDQpsZXQgYmVhdXRpZmllcg0KbGV0IG1vbmFjbw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGNvbXBvbmVudHM6IHt9LA0KICBwcm9wczogew0KICAgIGpzb25TdHI6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7fQ0KICB9LA0KICBjb21wdXRlZDoge30sDQogIHdhdGNoOiB7fSwNCiAgY3JlYXRlZCgpIHt9LA0KICBtb3VudGVkKCkgew0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5wcmV2ZW50RGVmYXVsdFNhdmUpDQogICAgY29uc3QgY2xpcGJvYXJkID0gbmV3IENsaXBib2FyZEpTKCcuY29weS1qc29uLWJ0bicsIHsNCiAgICAgIHRleHQ6IHRyaWdnZXIgPT4gew0KICAgICAgICB0aGlzLiRub3RpZnkoew0KICAgICAgICAgIHRpdGxlOiAn5oiQ5YqfJywNCiAgICAgICAgICBtZXNzYWdlOiAn5Luj56CB5bey5aSN5Yi25Yiw5Ymq5YiH5p2/77yM5Y+v57KY6LS044CCJywNCiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycNCiAgICAgICAgfSkNCiAgICAgICAgcmV0dXJuIHRoaXMuYmVhdXRpZmllckpzb24NCiAgICAgIH0NCiAgICB9KQ0KICAgIGNsaXBib2FyZC5vbignZXJyb3InLCBlID0+IHsNCiAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S7o+eggeWkjeWItuWksei0pScpDQogICAgfSkNCiAgfSwNCiAgYmVmb3JlRGVzdHJveSgpIHsNCiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMucHJldmVudERlZmF1bHRTYXZlKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgcHJldmVudERlZmF1bHRTYXZlKGUpIHsNCiAgICAgIGlmIChlLmtleSA9PT0gJ3MnICYmIChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5KSkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCkNCiAgICAgIH0NCiAgICB9LA0KICAgIG9uT3BlbigpIHsNCiAgICAgIGxvYWRCZWF1dGlmaWVyKGJ0ZiA9PiB7DQogICAgICAgIGJlYXV0aWZpZXIgPSBidGYNCiAgICAgICAgdGhpcy5iZWF1dGlmaWVySnNvbiA9IGJlYXV0aWZpZXIuanModGhpcy5qc29uU3RyLCBiZWF1dGlmaWVyQ29uZi5qcykNCg0KICAgICAgICBsb2FkTW9uYWNvKHZhbCA9PiB7DQogICAgICAgICAgbW9uYWNvID0gdmFsDQogICAgICAgICAgdGhpcy5zZXRFZGl0b3JWYWx1ZSgnZWRpdG9ySnNvbicsIHRoaXMuYmVhdXRpZmllckpzb24pDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgb25DbG9zZSgpIHt9LA0KICAgIHNldEVkaXRvclZhbHVlKGlkLCBjb2RlU3RyKSB7DQogICAgICBpZiAodGhpcy5qc29uRWRpdG9yKSB7DQogICAgICAgIHRoaXMuanNvbkVkaXRvci5zZXRWYWx1ZShjb2RlU3RyKQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5qc29uRWRpdG9yID0gbW9uYWNvLmVkaXRvci5jcmVhdGUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLCB7DQogICAgICAgICAgdmFsdWU6IGNvZGVTdHIsDQogICAgICAgICAgdGhlbWU6ICd2cy1kYXJrJywNCiAgICAgICAgICBsYW5ndWFnZTogJ2pzb24nLA0KICAgICAgICAgIGF1dG9tYXRpY0xheW91dDogdHJ1ZQ0KICAgICAgICB9KQ0KICAgICAgICAvLyBjdHJsICsgcyDliLfmlrANCiAgICAgICAgdGhpcy5qc29uRWRpdG9yLm9uS2V5RG93bihlID0+IHsNCiAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSA0OSAmJiAoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkpIHsNCiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgIH0sDQogICAgZXhwb3J0SnNvbkZpbGUoKSB7DQogICAgICB0aGlzLiRwcm9tcHQoJ+aWh+S7tuWQjTonLCAn5a+85Ye65paH5Lu2Jywgew0KICAgICAgICBpbnB1dFZhbHVlOiBgJHsrbmV3IERhdGUoKX0uanNvbmAsDQogICAgICAgIGNsb3NlT25DbGlja01vZGFsOiBmYWxzZSwNCiAgICAgICAgaW5wdXRQbGFjZWhvbGRlcjogJ+ivt+i+k+WFpeaWh+S7tuWQjScNCiAgICAgIH0pLnRoZW4oKHsgdmFsdWUgfSkgPT4gew0KICAgICAgICBpZiAoIXZhbHVlKSB2YWx1ZSA9IGAkeytuZXcgRGF0ZSgpfS5qc29uYA0KICAgICAgICBjb25zdCBjb2RlU3RyID0gdGhpcy5qc29uRWRpdG9yLmdldFZhbHVlKCkNCiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb2RlU3RyXSwgeyB0eXBlOiAndGV4dC9wbGFpbjtjaGFyc2V0PXV0Zi04JyB9KQ0KICAgICAgICBzYXZlQXMoYmxvYiwgdmFsdWUpDQogICAgICB9KQ0KICAgIH0sDQogICAgcmVmcmVzaCgpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIHRoaXMuJGVtaXQoJ3JlZnJlc2gnLCBKU09OLnBhcnNlKHRoaXMuanNvbkVkaXRvci5nZXRWYWx1ZSgpKSkNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIHRoaXMuJG5vdGlmeSh7DQogICAgICAgICAgdGl0bGU6ICfplJnor68nLA0KICAgICAgICAgIG1lc3NhZ2U6ICdKU09O5qC85byP6ZSZ6K+v77yM6K+35qOA5p+lJywNCiAgICAgICAgICB0eXBlOiAnZXJyb3InDQogICAgICAgIH0pDQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["JsonDrawer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JsonDrawer.vue","sourceRoot":"src/views/tool/build","sourcesContent":["<template>\r\n  <div>\r\n    <el-drawer v-bind=\"$attrs\" v-on=\"$listeners\" @opened=\"onOpen\" @close=\"onClose\">\r\n      <div class=\"action-bar\" :style=\"{'text-align': 'left'}\">\r\n        <span class=\"bar-btn\" @click=\"refresh\">\r\n          <i class=\"el-icon-refresh\" />\r\n          刷新\r\n        </span>\r\n        <span ref=\"copyBtn\" class=\"bar-btn copy-json-btn\">\r\n          <i class=\"el-icon-document-copy\" />\r\n          复制JSON\r\n        </span>\r\n        <span class=\"bar-btn\" @click=\"exportJsonFile\">\r\n          <i class=\"el-icon-download\" />\r\n          导出JSON文件\r\n        </span>\r\n        <span class=\"bar-btn delete-btn\" @click=\"$emit('update:visible', false)\">\r\n          <i class=\"el-icon-circle-close\" />\r\n          关闭\r\n        </span>\r\n      </div>\r\n      <div id=\"editorJson\" class=\"json-editor\" />\r\n    </el-drawer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { beautifierConf } from '@/utils'\r\nimport ClipboardJS from 'clipboard'\r\nimport { saveAs } from 'file-saver'\r\nimport loadMonaco from '@/utils/loadMonaco'\r\nimport loadBeautifier from '@/utils/loadBeautifier'\r\n\r\nlet beautifier\r\nlet monaco\r\n\r\nexport default {\r\n  components: {},\r\n  props: {\r\n    jsonStr: {\r\n      type: String,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {}\r\n  },\r\n  computed: {},\r\n  watch: {},\r\n  created() {},\r\n  mounted() {\r\n    window.addEventListener('keydown', this.preventDefaultSave)\r\n    const clipboard = new ClipboardJS('.copy-json-btn', {\r\n      text: trigger => {\r\n        this.$notify({\r\n          title: '成功',\r\n          message: '代码已复制到剪切板，可粘贴。',\r\n          type: 'success'\r\n        })\r\n        return this.beautifierJson\r\n      }\r\n    })\r\n    clipboard.on('error', e => {\r\n      this.$message.error('代码复制失败')\r\n    })\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('keydown', this.preventDefaultSave)\r\n  },\r\n  methods: {\r\n    preventDefaultSave(e) {\r\n      if (e.key === 's' && (e.metaKey || e.ctrlKey)) {\r\n        e.preventDefault()\r\n      }\r\n    },\r\n    onOpen() {\r\n      loadBeautifier(btf => {\r\n        beautifier = btf\r\n        this.beautifierJson = beautifier.js(this.jsonStr, beautifierConf.js)\r\n\r\n        loadMonaco(val => {\r\n          monaco = val\r\n          this.setEditorValue('editorJson', this.beautifierJson)\r\n        })\r\n      })\r\n    },\r\n    onClose() {},\r\n    setEditorValue(id, codeStr) {\r\n      if (this.jsonEditor) {\r\n        this.jsonEditor.setValue(codeStr)\r\n      } else {\r\n        this.jsonEditor = monaco.editor.create(document.getElementById(id), {\r\n          value: codeStr,\r\n          theme: 'vs-dark',\r\n          language: 'json',\r\n          automaticLayout: true\r\n        })\r\n        // ctrl + s 刷新\r\n        this.jsonEditor.onKeyDown(e => {\r\n          if (e.keyCode === 49 && (e.metaKey || e.ctrlKey)) {\r\n            this.refresh()\r\n          }\r\n        })\r\n      }\r\n    },\r\n    exportJsonFile() {\r\n      this.$prompt('文件名:', '导出文件', {\r\n        inputValue: `${+new Date()}.json`,\r\n        closeOnClickModal: false,\r\n        inputPlaceholder: '请输入文件名'\r\n      }).then(({ value }) => {\r\n        if (!value) value = `${+new Date()}.json`\r\n        const codeStr = this.jsonEditor.getValue()\r\n        const blob = new Blob([codeStr], { type: 'text/plain;charset=utf-8' })\r\n        saveAs(blob, value)\r\n      })\r\n    },\r\n    refresh() {\r\n      try {\r\n        this.$emit('refresh', JSON.parse(this.jsonEditor.getValue()))\r\n      } catch (error) {\r\n        this.$notify({\r\n          title: '错误',\r\n          message: 'JSON格式错误，请检查',\r\n          type: 'error'\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/styles/mixin.scss';\r\n\r\n::v-deep .el-drawer__header {\r\n  display: none;\r\n}\r\n@include action-bar;\r\n\r\n.json-editor{\r\n  height: calc(100vh - 33px);\r\n}\r\n</style>\r\n"]}]}